{"dependencies":[],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.cleanupCache = exports.listenersCache = void 0;\n  exports.observe = observe;\n  exports.listenersCache = new Map();\n  exports.cleanupCache = new Map();\n  let callbackCount = 0;\n  function observe(observerId, callbacks, fn) {\n    const callbackId = ++callbackCount;\n    const getListeners = () => exports.listenersCache.get(observerId) || [];\n    const unsubscribe = () => {\n      const listeners = getListeners();\n      exports.listenersCache.set(observerId, listeners.filter(cb => cb.id !== callbackId));\n    };\n    const unwatch = () => {\n      const listeners = getListeners();\n      if (!listeners.some(cb => cb.id === callbackId)) return;\n      const cleanup = exports.cleanupCache.get(observerId);\n      if (listeners.length === 1 && cleanup) {\n        const p = cleanup();\n        if (p instanceof Promise) p.catch(() => {});\n      }\n      unsubscribe();\n    };\n    const listeners = getListeners();\n    exports.listenersCache.set(observerId, [...listeners, {\n      id: callbackId,\n      fns: callbacks\n    }]);\n    if (listeners && listeners.length > 0) return unwatch;\n    const emit = {};\n    for (const key in callbacks) {\n      emit[key] = (...args) => {\n        const listeners = getListeners();\n        if (listeners.length === 0) return;\n        for (const listener of listeners) listener.fns[key]?.(...args);\n      };\n    }\n    const cleanup = fn(emit);\n    if (typeof cleanup === 'function') exports.cleanupCache.set(observerId, cleanup);\n    return unwatch;\n  }\n});","lineCount":47,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"cleanupCache"],[7,22,3,20],[7,25,3,23,"exports"],[7,32,3,30],[7,33,3,31,"listenersCache"],[7,47,3,45],[7,50,3,48],[7,55,3,53],[7,56,3,54],[8,2,4,0,"exports"],[8,9,4,7],[8,10,4,8,"observe"],[8,17,4,15],[8,20,4,18,"observe"],[8,27,4,25],[9,2,5,0,"exports"],[9,9,5,7],[9,10,5,8,"listenersCache"],[9,24,5,22],[9,27,5,25],[9,31,5,29,"Map"],[9,34,5,32],[9,35,5,33],[9,36,5,34],[10,2,6,0,"exports"],[10,9,6,7],[10,10,6,8,"cleanupCache"],[10,22,6,20],[10,25,6,23],[10,29,6,27,"Map"],[10,32,6,30],[10,33,6,31],[10,34,6,32],[11,2,7,0],[11,6,7,4,"callbackCount"],[11,19,7,17],[11,22,7,20],[11,23,7,21],[12,2,8,0],[12,11,8,9,"observe"],[12,18,8,16,"observe"],[12,19,8,17,"observerId"],[12,29,8,27],[12,31,8,29,"callbacks"],[12,40,8,38],[12,42,8,40,"fn"],[12,44,8,42],[12,46,8,44],[13,4,9,4],[13,10,9,10,"callbackId"],[13,20,9,20],[13,23,9,23],[13,25,9,25,"callbackCount"],[13,38,9,38],[14,4,10,4],[14,10,10,10,"getListeners"],[14,22,10,22],[14,25,10,25,"getListeners"],[14,26,10,25],[14,31,10,31,"exports"],[14,38,10,38],[14,39,10,39,"listenersCache"],[14,53,10,53],[14,54,10,54,"get"],[14,57,10,57],[14,58,10,58,"observerId"],[14,68,10,68],[14,69,10,69],[14,73,10,73],[14,75,10,75],[15,4,11,4],[15,10,11,10,"unsubscribe"],[15,21,11,21],[15,24,11,24,"unsubscribe"],[15,25,11,24],[15,30,11,30],[16,6,12,8],[16,12,12,14,"listeners"],[16,21,12,23],[16,24,12,26,"getListeners"],[16,36,12,38],[16,37,12,39],[16,38,12,40],[17,6,13,8,"exports"],[17,13,13,15],[17,14,13,16,"listenersCache"],[17,28,13,30],[17,29,13,31,"set"],[17,32,13,34],[17,33,13,35,"observerId"],[17,43,13,45],[17,45,13,47,"listeners"],[17,54,13,56],[17,55,13,57,"filter"],[17,61,13,63],[17,62,13,65,"cb"],[17,64,13,67],[17,68,13,72,"cb"],[17,70,13,74],[17,71,13,75,"id"],[17,73,13,77],[17,78,13,82,"callbackId"],[17,88,13,92],[17,89,13,93],[17,90,13,94],[18,4,14,4],[18,5,14,5],[19,4,15,4],[19,10,15,10,"unwatch"],[19,17,15,17],[19,20,15,20,"unwatch"],[19,21,15,20],[19,26,15,26],[20,6,16,8],[20,12,16,14,"listeners"],[20,21,16,23],[20,24,16,26,"getListeners"],[20,36,16,38],[20,37,16,39],[20,38,16,40],[21,6,17,8],[21,10,17,12],[21,11,17,13,"listeners"],[21,20,17,22],[21,21,17,23,"some"],[21,25,17,27],[21,26,17,29,"cb"],[21,28,17,31],[21,32,17,36,"cb"],[21,34,17,38],[21,35,17,39,"id"],[21,37,17,41],[21,42,17,46,"callbackId"],[21,52,17,56],[21,53,17,57],[21,55,18,12],[22,6,19,8],[22,12,19,14,"cleanup"],[22,19,19,21],[22,22,19,24,"exports"],[22,29,19,31],[22,30,19,32,"cleanupCache"],[22,42,19,44],[22,43,19,45,"get"],[22,46,19,48],[22,47,19,49,"observerId"],[22,57,19,59],[22,58,19,60],[23,6,20,8],[23,10,20,12,"listeners"],[23,19,20,21],[23,20,20,22,"length"],[23,26,20,28],[23,31,20,33],[23,32,20,34],[23,36,20,38,"cleanup"],[23,43,20,45],[23,45,20,47],[24,8,21,12],[24,14,21,18,"p"],[24,15,21,19],[24,18,21,22,"cleanup"],[24,25,21,29],[24,26,21,30],[24,27,21,31],[25,8,22,12],[25,12,22,16,"p"],[25,13,22,17],[25,25,22,29,"Promise"],[25,32,22,36],[25,34,23,16,"p"],[25,35,23,17],[25,36,23,18,"catch"],[25,41,23,23],[25,42,23,24],[25,48,23,30],[25,49,23,32],[25,50,23,33],[25,51,23,34],[26,6,24,8],[27,6,25,8,"unsubscribe"],[27,17,25,19],[27,18,25,20],[27,19,25,21],[28,4,26,4],[28,5,26,5],[29,4,27,4],[29,10,27,10,"listeners"],[29,19,27,19],[29,22,27,22,"getListeners"],[29,34,27,34],[29,35,27,35],[29,36,27,36],[30,4,28,4,"exports"],[30,11,28,11],[30,12,28,12,"listenersCache"],[30,26,28,26],[30,27,28,27,"set"],[30,30,28,30],[30,31,28,31,"observerId"],[30,41,28,41],[30,43,28,43],[30,44,29,8],[30,47,29,11,"listeners"],[30,56,29,20],[30,58,30,8],[31,6,30,10,"id"],[31,8,30,12],[31,10,30,14,"callbackId"],[31,20,30,24],[32,6,30,26,"fns"],[32,9,30,29],[32,11,30,31,"callbacks"],[33,4,30,41],[33,5,30,42],[33,6,31,5],[33,7,31,6],[34,4,32,4],[34,8,32,8,"listeners"],[34,17,32,17],[34,21,32,21,"listeners"],[34,30,32,30],[34,31,32,31,"length"],[34,37,32,37],[34,40,32,40],[34,41,32,41],[34,43,33,8],[34,50,33,15,"unwatch"],[34,57,33,22],[35,4,34,4],[35,10,34,10,"emit"],[35,14,34,14],[35,17,34,17],[35,18,34,18],[35,19,34,19],[36,4,35,4],[36,9,35,9],[36,15,35,15,"key"],[36,18,35,18],[36,22,35,22,"callbacks"],[36,31,35,31],[36,33,35,33],[37,6,36,8,"emit"],[37,10,36,12],[37,11,36,13,"key"],[37,14,36,16],[37,15,36,17],[37,18,36,21],[37,19,36,22],[37,22,36,25,"args"],[37,26,36,29],[37,31,36,34],[38,8,37,12],[38,14,37,18,"listeners"],[38,23,37,27],[38,26,37,30,"getListeners"],[38,38,37,42],[38,39,37,43],[38,40,37,44],[39,8,38,12],[39,12,38,16,"listeners"],[39,21,38,25],[39,22,38,26,"length"],[39,28,38,32],[39,33,38,37],[39,34,38,38],[39,36,39,16],[40,8,40,12],[40,13,40,17],[40,19,40,23,"listener"],[40,27,40,31],[40,31,40,35,"listeners"],[40,40,40,44],[40,42,41,16,"listener"],[40,50,41,24],[40,51,41,25,"fns"],[40,54,41,28],[40,55,41,29,"key"],[40,58,41,32],[40,59,41,33],[40,62,41,36],[40,65,41,39,"args"],[40,69,41,43],[40,70,41,44],[41,6,42,8],[41,7,42,10],[42,4,43,4],[43,4,44,4],[43,10,44,10,"cleanup"],[43,17,44,17],[43,20,44,20,"fn"],[43,22,44,22],[43,23,44,23,"emit"],[43,27,44,27],[43,28,44,28],[44,4,45,4],[44,8,45,8],[44,15,45,15,"cleanup"],[44,22,45,22],[44,27,45,27],[44,37,45,37],[44,39,46,8,"exports"],[44,46,46,15],[44,47,46,16,"cleanupCache"],[44,59,46,28],[44,60,46,29,"set"],[44,63,46,32],[44,64,46,33,"observerId"],[44,74,46,43],[44,76,46,45,"cleanup"],[44,83,46,52],[44,84,46,53],[45,4,47,4],[45,11,47,11,"unwatch"],[45,18,47,18],[46,2,48,0],[47,0,48,1],[47,3]],"functionMap":{"names":["<global>","observe","getListeners","unsubscribe","listeners.filter$argument_0","unwatch","listeners.some$argument_0","p._catch$argument_0","emit.key"],"mappings":"AAA;ACO;yBCE,kDD;wBEC;gECE,4BD;KFC;oBIC;4BCE,4BD;wBEM,SF;KJG;qBOU;SPM;CDM"},"hasCjsExports":true},"type":"js/module"}]}