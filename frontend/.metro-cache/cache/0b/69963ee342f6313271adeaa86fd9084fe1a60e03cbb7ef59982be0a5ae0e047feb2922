{"dependencies":[{"name":"../../errors/request.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":21,"index":119},"end":{"line":4,"column":55,"index":153}}],"key":"Bu6PYP3hUl2jiacy+OFL3cCcZHs=","exportNames":["*"],"imports":1}},{"name":"../../errors/transport.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":23,"index":178},"end":{"line":5,"column":59,"index":214}}],"key":"zWCiWm0X6zDiE+/d0erAkFo4VRM=","exportNames":["*"],"imports":1}},{"name":"../../utils/promise/createBatchScheduler.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":34,"index":250},"end":{"line":6,"column":88,"index":304}}],"key":"vzHnPpzWCJpiA0q0+gi8qs120Z0=","exportNames":["*"],"imports":1}},{"name":"../../utils/rpc/http.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":18,"index":324},"end":{"line":7,"column":52,"index":358}}],"key":"QyiCp0IujFpWkdzok21fehSFxhY=","exportNames":["*"],"imports":1}},{"name":"./createTransport.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":29,"index":389},"end":{"line":8,"column":60,"index":420}}],"key":"2KKCa+DiBTjCoOj7i5xHNLHMXm8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.http = http;\n  const request_js_1 = require(_dependencyMap[0], \"../../errors/request.js\");\n  const transport_js_1 = require(_dependencyMap[1], \"../../errors/transport.js\");\n  const createBatchScheduler_js_1 = require(_dependencyMap[2], \"../../utils/promise/createBatchScheduler.js\");\n  const http_js_1 = require(_dependencyMap[3], \"../../utils/rpc/http.js\");\n  const createTransport_js_1 = require(_dependencyMap[4], \"./createTransport.js\");\n  function http(url, config = {}) {\n    const {\n      batch,\n      fetchFn,\n      fetchOptions,\n      key = 'http',\n      methods,\n      name = 'HTTP JSON-RPC',\n      onFetchRequest,\n      onFetchResponse,\n      retryDelay,\n      raw\n    } = config;\n    return ({\n      chain,\n      retryCount: retryCount_,\n      timeout: timeout_\n    }) => {\n      const {\n        batchSize = 1000,\n        wait = 0\n      } = typeof batch === 'object' ? batch : {};\n      const retryCount = config.retryCount ?? retryCount_;\n      const timeout = timeout_ ?? config.timeout ?? 10_000;\n      const url_ = url || chain?.rpcUrls.default.http[0];\n      if (!url_) throw new transport_js_1.UrlRequiredError();\n      const rpcClient = (0, http_js_1.getHttpRpcClient)(url_, {\n        fetchFn,\n        fetchOptions,\n        onRequest: onFetchRequest,\n        onResponse: onFetchResponse,\n        timeout\n      });\n      return (0, createTransport_js_1.createTransport)({\n        key,\n        methods,\n        name,\n        async request({\n          method,\n          params\n        }) {\n          const body = {\n            method,\n            params\n          };\n          const {\n            schedule\n          } = (0, createBatchScheduler_js_1.createBatchScheduler)({\n            id: url_,\n            wait,\n            shouldSplitBatch(requests) {\n              return requests.length > batchSize;\n            },\n            fn: body => rpcClient.request({\n              body\n            }),\n            sort: (a, b) => a.id - b.id\n          });\n          const fn = async body => batch ? schedule(body) : [await rpcClient.request({\n            body\n          })];\n          const [{\n            error,\n            result\n          }] = await fn(body);\n          if (raw) return {\n            error,\n            result\n          };\n          if (error) throw new request_js_1.RpcRequestError({\n            body,\n            error,\n            url: url_\n          });\n          return result;\n        },\n        retryCount,\n        retryDelay,\n        timeout,\n        type: 'http'\n      }, {\n        fetchOptions,\n        url: url_\n      });\n    };\n  }\n});","lineCount":99,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"http"],[7,14,3,12],[7,17,3,15,"http"],[7,21,3,19],[8,2,4,0],[8,8,4,6,"request_js_1"],[8,20,4,18],[8,23,4,21,"require"],[8,30,4,28],[8,31,4,28,"_dependencyMap"],[8,45,4,28],[8,75,4,54],[8,76,4,55],[9,2,5,0],[9,8,5,6,"transport_js_1"],[9,22,5,20],[9,25,5,23,"require"],[9,32,5,30],[9,33,5,30,"_dependencyMap"],[9,47,5,30],[9,79,5,58],[9,80,5,59],[10,2,6,0],[10,8,6,6,"createBatchScheduler_js_1"],[10,33,6,31],[10,36,6,34,"require"],[10,43,6,41],[10,44,6,41,"_dependencyMap"],[10,58,6,41],[10,108,6,87],[10,109,6,88],[11,2,7,0],[11,8,7,6,"http_js_1"],[11,17,7,15],[11,20,7,18,"require"],[11,27,7,25],[11,28,7,25,"_dependencyMap"],[11,42,7,25],[11,72,7,51],[11,73,7,52],[12,2,8,0],[12,8,8,6,"createTransport_js_1"],[12,28,8,26],[12,31,8,29,"require"],[12,38,8,36],[12,39,8,36,"_dependencyMap"],[12,53,8,36],[12,80,8,59],[12,81,8,60],[13,2,9,0],[13,11,9,9,"http"],[13,15,9,13,"http"],[13,16,9,14,"url"],[13,19,9,17],[13,21,9,19,"config"],[13,27,9,25],[13,30,9,28],[13,31,9,29],[13,32,9,30],[13,34,9,32],[14,4,10,4],[14,10,10,10],[15,6,10,12,"batch"],[15,11,10,17],[16,6,10,19,"fetchFn"],[16,13,10,26],[17,6,10,28,"fetchOptions"],[17,18,10,40],[18,6,10,42,"key"],[18,9,10,45],[18,12,10,48],[18,18,10,54],[19,6,10,56,"methods"],[19,13,10,63],[20,6,10,65,"name"],[20,10,10,69],[20,13,10,72],[20,28,10,87],[21,6,10,89,"onFetchRequest"],[21,20,10,103],[22,6,10,105,"onFetchResponse"],[22,21,10,120],[23,6,10,122,"retryDelay"],[23,16,10,132],[24,6,10,134,"raw"],[25,4,10,139],[25,5,10,140],[25,8,10,143,"config"],[25,14,10,149],[26,4,11,4],[26,11,11,11],[26,12,11,12],[27,6,11,14,"chain"],[27,11,11,19],[28,6,11,21,"retryCount"],[28,16,11,31],[28,18,11,33,"retryCount_"],[28,29,11,44],[29,6,11,46,"timeout"],[29,13,11,53],[29,15,11,55,"timeout_"],[30,4,11,64],[30,5,11,65],[30,10,11,70],[31,6,12,8],[31,12,12,14],[32,8,12,16,"batchSize"],[32,17,12,25],[32,20,12,28],[32,24,12,32],[33,8,12,34,"wait"],[33,12,12,38],[33,15,12,41],[34,6,12,43],[34,7,12,44],[34,10,12,47],[34,17,12,54,"batch"],[34,22,12,59],[34,27,12,64],[34,35,12,72],[34,38,12,75,"batch"],[34,43,12,80],[34,46,12,83],[34,47,12,84],[34,48,12,85],[35,6,13,8],[35,12,13,14,"retryCount"],[35,22,13,24],[35,25,13,27,"config"],[35,31,13,33],[35,32,13,34,"retryCount"],[35,42,13,44],[35,46,13,48,"retryCount_"],[35,57,13,59],[36,6,14,8],[36,12,14,14,"timeout"],[36,19,14,21],[36,22,14,24,"timeout_"],[36,30,14,32],[36,34,14,36,"config"],[36,40,14,42],[36,41,14,43,"timeout"],[36,48,14,50],[36,52,14,54],[36,58,14,60],[37,6,15,8],[37,12,15,14,"url_"],[37,16,15,18],[37,19,15,21,"url"],[37,22,15,24],[37,26,15,28,"chain"],[37,31,15,33],[37,33,15,35,"rpcUrls"],[37,40,15,42],[37,41,15,43,"default"],[37,48,15,50],[37,49,15,51,"http"],[37,53,15,55],[37,54,15,56],[37,55,15,57],[37,56,15,58],[38,6,16,8],[38,10,16,12],[38,11,16,13,"url_"],[38,15,16,17],[38,17,17,12],[38,23,17,18],[38,27,17,22,"transport_js_1"],[38,41,17,36],[38,42,17,37,"UrlRequiredError"],[38,58,17,53],[38,59,17,54],[38,60,17,55],[39,6,18,8],[39,12,18,14,"rpcClient"],[39,21,18,23],[39,24,18,26],[39,25,18,27],[39,26,18,28],[39,28,18,30,"http_js_1"],[39,37,18,39],[39,38,18,40,"getHttpRpcClient"],[39,54,18,56],[39,56,18,58,"url_"],[39,60,18,62],[39,62,18,64],[40,8,19,12,"fetchFn"],[40,15,19,19],[41,8,20,12,"fetchOptions"],[41,20,20,24],[42,8,21,12,"onRequest"],[42,17,21,21],[42,19,21,23,"onFetchRequest"],[42,33,21,37],[43,8,22,12,"onResponse"],[43,18,22,22],[43,20,22,24,"onFetchResponse"],[43,35,22,39],[44,8,23,12,"timeout"],[45,6,24,8],[45,7,24,9],[45,8,24,10],[46,6,25,8],[46,13,25,15],[46,14,25,16],[46,15,25,17],[46,17,25,19,"createTransport_js_1"],[46,37,25,39],[46,38,25,40,"createTransport"],[46,53,25,55],[46,55,25,57],[47,8,26,12,"key"],[47,11,26,15],[48,8,27,12,"methods"],[48,15,27,19],[49,8,28,12,"name"],[49,12,28,16],[50,8,29,12],[50,14,29,18,"request"],[50,21,29,25,"request"],[50,22,29,26],[51,10,29,28,"method"],[51,16,29,34],[52,10,29,36,"params"],[53,8,29,43],[53,9,29,44],[53,11,29,46],[54,10,30,16],[54,16,30,22,"body"],[54,20,30,26],[54,23,30,29],[55,12,30,31,"method"],[55,18,30,37],[56,12,30,39,"params"],[57,10,30,46],[57,11,30,47],[58,10,31,16],[58,16,31,22],[59,12,31,24,"schedule"],[60,10,31,33],[60,11,31,34],[60,14,31,37],[60,15,31,38],[60,16,31,39],[60,18,31,41,"createBatchScheduler_js_1"],[60,43,31,66],[60,44,31,67,"createBatchScheduler"],[60,64,31,87],[60,66,31,89],[61,12,32,20,"id"],[61,14,32,22],[61,16,32,24,"url_"],[61,20,32,28],[62,12,33,20,"wait"],[62,16,33,24],[63,12,34,20,"shouldSplitBatch"],[63,28,34,36,"shouldSplitBatch"],[63,29,34,37,"requests"],[63,37,34,45],[63,39,34,47],[64,14,35,24],[64,21,35,31,"requests"],[64,29,35,39],[64,30,35,40,"length"],[64,36,35,46],[64,39,35,49,"batchSize"],[64,48,35,58],[65,12,36,20],[65,13,36,21],[66,12,37,20,"fn"],[66,14,37,22],[66,16,37,25,"body"],[66,20,37,29],[66,24,37,34,"rpcClient"],[66,33,37,43],[66,34,37,44,"request"],[66,41,37,51],[66,42,37,52],[67,14,38,24,"body"],[68,12,39,20],[68,13,39,21],[68,14,39,22],[69,12,40,20,"sort"],[69,16,40,24],[69,18,40,26,"sort"],[69,19,40,27,"a"],[69,20,40,28],[69,22,40,30,"b"],[69,23,40,31],[69,28,40,36,"a"],[69,29,40,37],[69,30,40,38,"id"],[69,32,40,40],[69,35,40,43,"b"],[69,36,40,44],[69,37,40,45,"id"],[70,10,41,16],[70,11,41,17],[70,12,41,18],[71,10,42,16],[71,16,42,22,"fn"],[71,18,42,24],[71,21,42,27],[71,27,42,34,"body"],[71,31,42,38],[71,35,42,43,"batch"],[71,40,42,48],[71,43,43,22,"schedule"],[71,51,43,30],[71,52,43,31,"body"],[71,56,43,35],[71,57,43,36],[71,60,44,22],[71,61,45,24],[71,67,45,30,"rpcClient"],[71,76,45,39],[71,77,45,40,"request"],[71,84,45,47],[71,85,45,48],[72,12,46,28,"body"],[73,10,47,24],[73,11,47,25],[73,12,47,26],[73,13,48,21],[74,10,49,16],[74,16,49,22],[74,17,49,23],[75,12,49,25,"error"],[75,17,49,30],[76,12,49,32,"result"],[77,10,49,39],[77,11,49,40],[77,12,49,41],[77,15,49,44],[77,21,49,50,"fn"],[77,23,49,52],[77,24,49,53,"body"],[77,28,49,57],[77,29,49,58],[78,10,50,16],[78,14,50,20,"raw"],[78,17,50,23],[78,19,51,20],[78,26,51,27],[79,12,51,29,"error"],[79,17,51,34],[80,12,51,36,"result"],[81,10,51,43],[81,11,51,44],[82,10,52,16],[82,14,52,20,"error"],[82,19,52,25],[82,21,53,20],[82,27,53,26],[82,31,53,30,"request_js_1"],[82,43,53,42],[82,44,53,43,"RpcRequestError"],[82,59,53,58],[82,60,53,59],[83,12,54,24,"body"],[83,16,54,28],[84,12,55,24,"error"],[84,17,55,29],[85,12,56,24,"url"],[85,15,56,27],[85,17,56,29,"url_"],[86,10,57,20],[86,11,57,21],[86,12,57,22],[87,10,58,16],[87,17,58,23,"result"],[87,23,58,29],[88,8,59,12],[88,9,59,13],[89,8,60,12,"retryCount"],[89,18,60,22],[90,8,61,12,"retryDelay"],[90,18,61,22],[91,8,62,12,"timeout"],[91,15,62,19],[92,8,63,12,"type"],[92,12,63,16],[92,14,63,18],[93,6,64,8],[93,7,64,9],[93,9,64,11],[94,8,65,12,"fetchOptions"],[94,20,65,24],[95,8,66,12,"url"],[95,11,66,15],[95,13,66,17,"url_"],[96,6,67,8],[96,7,67,9],[96,8,67,10],[97,4,68,4],[97,5,68,5],[98,2,69,0],[99,0,69,1],[99,3]],"functionMap":{"names":["<global>","http","<anonymous>","request","shouldSplitBatch","fn","sort"],"mappings":"AAA;ACQ;WCE;YCkB;oBCK;qBDE;wBEC;sBFE;0BGC,qBH;2BEE;qBFM;aDW;KDS;CDC"},"hasCjsExports":true},"type":"js/module"}]}