{"dependencies":[{"name":"../../errors/request.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":21,"index":129},"end":{"line":4,"column":55,"index":163}}],"key":"Bu6PYP3hUl2jiacy+OFL3cCcZHs=","exportNames":["*"],"imports":1}},{"name":"../../errors/transport.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":23,"index":188},"end":{"line":5,"column":59,"index":224}}],"key":"zWCiWm0X6zDiE+/d0erAkFo4VRM=","exportNames":["*"],"imports":1}},{"name":"../../utils/rpc/compat.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":20,"index":246},"end":{"line":6,"column":56,"index":282}}],"key":"q/adGe8MlQaOJQCFIDwvr3ETeWc=","exportNames":["*"],"imports":1}},{"name":"../../utils/rpc/webSocket.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":23,"index":307},"end":{"line":7,"column":62,"index":346}}],"key":"W+twNTor4FMBuXnSTPA769ofcEk=","exportNames":["*"],"imports":1}},{"name":"./createTransport.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":29,"index":377},"end":{"line":8,"column":60,"index":408}}],"key":"2KKCa+DiBTjCoOj7i5xHNLHMXm8=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.webSocket = webSocket;\n  const request_js_1 = require(_dependencyMap[0], \"../../errors/request.js\");\n  const transport_js_1 = require(_dependencyMap[1], \"../../errors/transport.js\");\n  const compat_js_1 = require(_dependencyMap[2], \"../../utils/rpc/compat.js\");\n  const webSocket_js_1 = require(_dependencyMap[3], \"../../utils/rpc/webSocket.js\");\n  const createTransport_js_1 = require(_dependencyMap[4], \"./createTransport.js\");\n  function webSocket(url, config = {}) {\n    const {\n      keepAlive,\n      key = 'webSocket',\n      methods,\n      name = 'WebSocket JSON-RPC',\n      reconnect,\n      retryDelay\n    } = config;\n    return ({\n      chain,\n      retryCount: retryCount_,\n      timeout: timeout_\n    }) => {\n      const retryCount = config.retryCount ?? retryCount_;\n      const timeout = timeout_ ?? config.timeout ?? 10_000;\n      const url_ = url || chain?.rpcUrls.default.webSocket?.[0];\n      const wsRpcClientOpts = {\n        keepAlive,\n        reconnect\n      };\n      if (!url_) throw new transport_js_1.UrlRequiredError();\n      return (0, createTransport_js_1.createTransport)({\n        key,\n        methods,\n        name,\n        async request({\n          method,\n          params\n        }) {\n          const body = {\n            method,\n            params\n          };\n          const rpcClient = await (0, webSocket_js_1.getWebSocketRpcClient)(url_, wsRpcClientOpts);\n          const {\n            error,\n            result\n          } = await rpcClient.requestAsync({\n            body,\n            timeout\n          });\n          if (error) throw new request_js_1.RpcRequestError({\n            body,\n            error,\n            url: url_\n          });\n          return result;\n        },\n        retryCount,\n        retryDelay,\n        timeout,\n        type: 'webSocket'\n      }, {\n        getSocket() {\n          return (0, compat_js_1.getSocket)(url_);\n        },\n        getRpcClient() {\n          return (0, webSocket_js_1.getWebSocketRpcClient)(url_, wsRpcClientOpts);\n        },\n        async subscribe({\n          params,\n          onData,\n          onError\n        }) {\n          const rpcClient = await (0, webSocket_js_1.getWebSocketRpcClient)(url_, wsRpcClientOpts);\n          const {\n            result: subscriptionId\n          } = await new Promise((resolve, reject) => rpcClient.request({\n            body: {\n              method: 'eth_subscribe',\n              params\n            },\n            onError(error) {\n              reject(error);\n              onError?.(error);\n              return;\n            },\n            onResponse(response) {\n              if (response.error) {\n                reject(response.error);\n                onError?.(response.error);\n                return;\n              }\n              if (typeof response.id === 'number') {\n                resolve(response);\n                return;\n              }\n              if (response.method !== 'eth_subscription') return;\n              onData(response.params);\n            }\n          }));\n          return {\n            subscriptionId,\n            async unsubscribe() {\n              return new Promise(resolve => rpcClient.request({\n                body: {\n                  method: 'eth_unsubscribe',\n                  params: [subscriptionId]\n                },\n                onResponse: resolve\n              }));\n            }\n          };\n        }\n      });\n    };\n  }\n});","lineCount":121,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"webSocket"],[7,19,3,17],[7,22,3,20,"webSocket"],[7,31,3,29],[8,2,4,0],[8,8,4,6,"request_js_1"],[8,20,4,18],[8,23,4,21,"require"],[8,30,4,28],[8,31,4,28,"_dependencyMap"],[8,45,4,28],[8,75,4,54],[8,76,4,55],[9,2,5,0],[9,8,5,6,"transport_js_1"],[9,22,5,20],[9,25,5,23,"require"],[9,32,5,30],[9,33,5,30,"_dependencyMap"],[9,47,5,30],[9,79,5,58],[9,80,5,59],[10,2,6,0],[10,8,6,6,"compat_js_1"],[10,19,6,17],[10,22,6,20,"require"],[10,29,6,27],[10,30,6,27,"_dependencyMap"],[10,44,6,27],[10,76,6,55],[10,77,6,56],[11,2,7,0],[11,8,7,6,"webSocket_js_1"],[11,22,7,20],[11,25,7,23,"require"],[11,32,7,30],[11,33,7,30,"_dependencyMap"],[11,47,7,30],[11,82,7,61],[11,83,7,62],[12,2,8,0],[12,8,8,6,"createTransport_js_1"],[12,28,8,26],[12,31,8,29,"require"],[12,38,8,36],[12,39,8,36,"_dependencyMap"],[12,53,8,36],[12,80,8,59],[12,81,8,60],[13,2,9,0],[13,11,9,9,"webSocket"],[13,20,9,18,"webSocket"],[13,21,9,19,"url"],[13,24,9,22],[13,26,9,24,"config"],[13,32,9,30],[13,35,9,33],[13,36,9,34],[13,37,9,35],[13,39,9,37],[14,4,10,4],[14,10,10,10],[15,6,10,12,"keepAlive"],[15,15,10,21],[16,6,10,23,"key"],[16,9,10,26],[16,12,10,29],[16,23,10,40],[17,6,10,42,"methods"],[17,13,10,49],[18,6,10,51,"name"],[18,10,10,55],[18,13,10,58],[18,33,10,78],[19,6,10,80,"reconnect"],[19,15,10,89],[20,6,10,91,"retryDelay"],[21,4,10,103],[21,5,10,104],[21,8,10,107,"config"],[21,14,10,113],[22,4,11,4],[22,11,11,11],[22,12,11,12],[23,6,11,14,"chain"],[23,11,11,19],[24,6,11,21,"retryCount"],[24,16,11,31],[24,18,11,33,"retryCount_"],[24,29,11,44],[25,6,11,46,"timeout"],[25,13,11,53],[25,15,11,55,"timeout_"],[26,4,11,64],[26,5,11,65],[26,10,11,70],[27,6,12,8],[27,12,12,14,"retryCount"],[27,22,12,24],[27,25,12,27,"config"],[27,31,12,33],[27,32,12,34,"retryCount"],[27,42,12,44],[27,46,12,48,"retryCount_"],[27,57,12,59],[28,6,13,8],[28,12,13,14,"timeout"],[28,19,13,21],[28,22,13,24,"timeout_"],[28,30,13,32],[28,34,13,36,"config"],[28,40,13,42],[28,41,13,43,"timeout"],[28,48,13,50],[28,52,13,54],[28,58,13,60],[29,6,14,8],[29,12,14,14,"url_"],[29,16,14,18],[29,19,14,21,"url"],[29,22,14,24],[29,26,14,28,"chain"],[29,31,14,33],[29,33,14,35,"rpcUrls"],[29,40,14,42],[29,41,14,43,"default"],[29,48,14,50],[29,49,14,51,"webSocket"],[29,58,14,60],[29,61,14,63],[29,62,14,64],[29,63,14,65],[30,6,15,8],[30,12,15,14,"wsRpcClientOpts"],[30,27,15,29],[30,30,15,32],[31,8,15,34,"keepAlive"],[31,17,15,43],[32,8,15,45,"reconnect"],[33,6,15,55],[33,7,15,56],[34,6,16,8],[34,10,16,12],[34,11,16,13,"url_"],[34,15,16,17],[34,17,17,12],[34,23,17,18],[34,27,17,22,"transport_js_1"],[34,41,17,36],[34,42,17,37,"UrlRequiredError"],[34,58,17,53],[34,59,17,54],[34,60,17,55],[35,6,18,8],[35,13,18,15],[35,14,18,16],[35,15,18,17],[35,17,18,19,"createTransport_js_1"],[35,37,18,39],[35,38,18,40,"createTransport"],[35,53,18,55],[35,55,18,57],[36,8,19,12,"key"],[36,11,19,15],[37,8,20,12,"methods"],[37,15,20,19],[38,8,21,12,"name"],[38,12,21,16],[39,8,22,12],[39,14,22,18,"request"],[39,21,22,25,"request"],[39,22,22,26],[40,10,22,28,"method"],[40,16,22,34],[41,10,22,36,"params"],[42,8,22,43],[42,9,22,44],[42,11,22,46],[43,10,23,16],[43,16,23,22,"body"],[43,20,23,26],[43,23,23,29],[44,12,23,31,"method"],[44,18,23,37],[45,12,23,39,"params"],[46,10,23,46],[46,11,23,47],[47,10,24,16],[47,16,24,22,"rpcClient"],[47,25,24,31],[47,28,24,34],[47,34,24,40],[47,35,24,41],[47,36,24,42],[47,38,24,44,"webSocket_js_1"],[47,52,24,58],[47,53,24,59,"getWebSocketRpcClient"],[47,74,24,80],[47,76,24,82,"url_"],[47,80,24,86],[47,82,24,88,"wsRpcClientOpts"],[47,97,24,103],[47,98,24,104],[48,10,25,16],[48,16,25,22],[49,12,25,24,"error"],[49,17,25,29],[50,12,25,31,"result"],[51,10,25,38],[51,11,25,39],[51,14,25,42],[51,20,25,48,"rpcClient"],[51,29,25,57],[51,30,25,58,"requestAsync"],[51,42,25,70],[51,43,25,71],[52,12,26,20,"body"],[52,16,26,24],[53,12,27,20,"timeout"],[54,10,28,16],[54,11,28,17],[54,12,28,18],[55,10,29,16],[55,14,29,20,"error"],[55,19,29,25],[55,21,30,20],[55,27,30,26],[55,31,30,30,"request_js_1"],[55,43,30,42],[55,44,30,43,"RpcRequestError"],[55,59,30,58],[55,60,30,59],[56,12,31,24,"body"],[56,16,31,28],[57,12,32,24,"error"],[57,17,32,29],[58,12,33,24,"url"],[58,15,33,27],[58,17,33,29,"url_"],[59,10,34,20],[59,11,34,21],[59,12,34,22],[60,10,35,16],[60,17,35,23,"result"],[60,23,35,29],[61,8,36,12],[61,9,36,13],[62,8,37,12,"retryCount"],[62,18,37,22],[63,8,38,12,"retryDelay"],[63,18,38,22],[64,8,39,12,"timeout"],[64,15,39,19],[65,8,40,12,"type"],[65,12,40,16],[65,14,40,18],[66,6,41,8],[66,7,41,9],[66,9,41,11],[67,8,42,12,"getSocket"],[67,17,42,21,"getSocket"],[67,18,42,21],[67,20,42,24],[68,10,43,16],[68,17,43,23],[68,18,43,24],[68,19,43,25],[68,21,43,27,"compat_js_1"],[68,32,43,38],[68,33,43,39,"getSocket"],[68,42,43,48],[68,44,43,50,"url_"],[68,48,43,54],[68,49,43,55],[69,8,44,12],[69,9,44,13],[70,8,45,12,"getRpcClient"],[70,20,45,24,"getRpcClient"],[70,21,45,24],[70,23,45,27],[71,10,46,16],[71,17,46,23],[71,18,46,24],[71,19,46,25],[71,21,46,27,"webSocket_js_1"],[71,35,46,41],[71,36,46,42,"getWebSocketRpcClient"],[71,57,46,63],[71,59,46,65,"url_"],[71,63,46,69],[71,65,46,71,"wsRpcClientOpts"],[71,80,46,86],[71,81,46,87],[72,8,47,12],[72,9,47,13],[73,8,48,12],[73,14,48,18,"subscribe"],[73,23,48,27,"subscribe"],[73,24,48,28],[74,10,48,30,"params"],[74,16,48,36],[75,10,48,38,"onData"],[75,16,48,44],[76,10,48,46,"onError"],[77,8,48,54],[77,9,48,55],[77,11,48,57],[78,10,49,16],[78,16,49,22,"rpcClient"],[78,25,49,31],[78,28,49,34],[78,34,49,40],[78,35,49,41],[78,36,49,42],[78,38,49,44,"webSocket_js_1"],[78,52,49,58],[78,53,49,59,"getWebSocketRpcClient"],[78,74,49,80],[78,76,49,82,"url_"],[78,80,49,86],[78,82,49,88,"wsRpcClientOpts"],[78,97,49,103],[78,98,49,104],[79,10,50,16],[79,16,50,22],[80,12,50,24,"result"],[80,18,50,30],[80,20,50,32,"subscriptionId"],[81,10,50,47],[81,11,50,48],[81,14,50,51],[81,20,50,57],[81,24,50,61,"Promise"],[81,31,50,68],[81,32,50,69],[81,33,50,70,"resolve"],[81,40,50,77],[81,42,50,79,"reject"],[81,48,50,85],[81,53,50,90,"rpcClient"],[81,62,50,99],[81,63,50,100,"request"],[81,70,50,107],[81,71,50,108],[82,12,51,20,"body"],[82,16,51,24],[82,18,51,26],[83,14,52,24,"method"],[83,20,52,30],[83,22,52,32],[83,37,52,47],[84,14,53,24,"params"],[85,12,54,20],[85,13,54,21],[86,12,55,20,"onError"],[86,19,55,27,"onError"],[86,20,55,28,"error"],[86,25,55,33],[86,27,55,35],[87,14,56,24,"reject"],[87,20,56,30],[87,21,56,31,"error"],[87,26,56,36],[87,27,56,37],[88,14,57,24,"onError"],[88,21,57,31],[88,24,57,34,"error"],[88,29,57,39],[88,30,57,40],[89,14,58,24],[90,12,59,20],[90,13,59,21],[91,12,60,20,"onResponse"],[91,22,60,30,"onResponse"],[91,23,60,31,"response"],[91,31,60,39],[91,33,60,41],[92,14,61,24],[92,18,61,28,"response"],[92,26,61,36],[92,27,61,37,"error"],[92,32,61,42],[92,34,61,44],[93,16,62,28,"reject"],[93,22,62,34],[93,23,62,35,"response"],[93,31,62,43],[93,32,62,44,"error"],[93,37,62,49],[93,38,62,50],[94,16,63,28,"onError"],[94,23,63,35],[94,26,63,38,"response"],[94,34,63,46],[94,35,63,47,"error"],[94,40,63,52],[94,41,63,53],[95,16,64,28],[96,14,65,24],[97,14,66,24],[97,18,66,28],[97,25,66,35,"response"],[97,33,66,43],[97,34,66,44,"id"],[97,36,66,46],[97,41,66,51],[97,49,66,59],[97,51,66,61],[98,16,67,28,"resolve"],[98,23,67,35],[98,24,67,36,"response"],[98,32,67,44],[98,33,67,45],[99,16,68,28],[100,14,69,24],[101,14,70,24],[101,18,70,28,"response"],[101,26,70,36],[101,27,70,37,"method"],[101,33,70,43],[101,38,70,48],[101,56,70,66],[101,58,71,28],[102,14,72,24,"onData"],[102,20,72,30],[102,21,72,31,"response"],[102,29,72,39],[102,30,72,40,"params"],[102,36,72,46],[102,37,72,47],[103,12,73,20],[104,10,74,16],[104,11,74,17],[104,12,74,18],[104,13,74,19],[105,10,75,16],[105,17,75,23],[106,12,76,20,"subscriptionId"],[106,26,76,34],[107,12,77,20],[107,18,77,26,"unsubscribe"],[107,29,77,37,"unsubscribe"],[107,30,77,37],[107,32,77,40],[108,14,78,24],[108,21,78,31],[108,25,78,35,"Promise"],[108,32,78,42],[108,33,78,44,"resolve"],[108,40,78,51],[108,44,78,56,"rpcClient"],[108,53,78,65],[108,54,78,66,"request"],[108,61,78,73],[108,62,78,74],[109,16,79,28,"body"],[109,20,79,32],[109,22,79,34],[110,18,80,32,"method"],[110,24,80,38],[110,26,80,40],[110,43,80,57],[111,18,81,32,"params"],[111,24,81,38],[111,26,81,40],[111,27,81,41,"subscriptionId"],[111,41,81,55],[112,16,82,28],[112,17,82,29],[113,16,83,28,"onResponse"],[113,26,83,38],[113,28,83,40,"resolve"],[114,14,84,24],[114,15,84,25],[114,16,84,26],[114,17,84,27],[115,12,85,20],[116,10,86,16],[116,11,86,17],[117,8,87,12],[118,6,88,8],[118,7,88,9],[118,8,88,10],[119,4,89,4],[119,5,89,5],[120,2,90,0],[121,0,90,1],[121,3]],"functionMap":{"names":["<global>","webSocket","<anonymous>","request","getSocket","getRpcClient","subscribe","Promise$argument_0","rpcClient.request$argument_0.onError","rpcClient.request$argument_0.onResponse","unsubscribe"],"mappings":"AAA;ACQ;WCE;YCW;aDc;YEM;aFE;YGC;aHE;YIC;qECE;oBCK;qBDI;oBEC;qBFa;kBDC;oBIG;2CHC;0BGM;qBJC;aJE;KDE;CDC"},"hasCjsExports":true},"type":"js/module"}]}