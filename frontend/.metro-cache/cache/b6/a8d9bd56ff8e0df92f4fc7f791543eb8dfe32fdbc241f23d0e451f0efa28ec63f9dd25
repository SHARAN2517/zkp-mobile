{"dependencies":[{"name":"../../utils/getAction.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":4,"column":23,"index":161},"end":{"line":4,"column":58,"index":196}}],"key":"d685V9n1u7O1oRJ2ZbnkuLpcslA=","exportNames":["*"],"imports":1}},{"name":"../../utils/observe.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":5,"column":21,"index":219},"end":{"line":5,"column":54,"index":252}}],"key":"NlEDsinWPPoPV3uHdXDCPvBuxx8=","exportNames":["*"],"imports":1}},{"name":"../../utils/poll.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":6,"column":18,"index":272},"end":{"line":6,"column":48,"index":302}}],"key":"VGDCY0JetsesgNJKn2v/Q97mlvo=","exportNames":["*"],"imports":1}},{"name":"../../utils/stringify.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":7,"column":23,"index":327},"end":{"line":7,"column":58,"index":362}}],"key":"o4d2CDgTn514XnsqOYcryKEOe1A=","exportNames":["*"],"imports":1}},{"name":"./createPendingTransactionFilter.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":8,"column":44,"index":408},"end":{"line":8,"column":90,"index":454}}],"key":"1LuOdCLk4tkPtJ/W2xfqrSQ4Xho=","exportNames":["*"],"imports":1}},{"name":"./getFilterChanges.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":9,"column":30,"index":486},"end":{"line":9,"column":62,"index":518}}],"key":"GUIk7VL7OKREeYj4rJfECzzhnZQ=","exportNames":["*"],"imports":1}},{"name":"./uninstallFilter.js","data":{"asyncType":null,"isESMImport":false,"locs":[{"start":{"line":10,"column":29,"index":549},"end":{"line":10,"column":60,"index":580}}],"key":"24TFPkjx+osNgjqGLLaNULbtZHY=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.watchPendingTransactions = watchPendingTransactions;\n  const getAction_js_1 = require(_dependencyMap[0], \"../../utils/getAction.js\");\n  const observe_js_1 = require(_dependencyMap[1], \"../../utils/observe.js\");\n  const poll_js_1 = require(_dependencyMap[2], \"../../utils/poll.js\");\n  const stringify_js_1 = require(_dependencyMap[3], \"../../utils/stringify.js\");\n  const createPendingTransactionFilter_js_1 = require(_dependencyMap[4], \"./createPendingTransactionFilter.js\");\n  const getFilterChanges_js_1 = require(_dependencyMap[5], \"./getFilterChanges.js\");\n  const uninstallFilter_js_1 = require(_dependencyMap[6], \"./uninstallFilter.js\");\n  function watchPendingTransactions(client, {\n    batch = true,\n    onError,\n    onTransactions,\n    poll: poll_,\n    pollingInterval = client.pollingInterval\n  }) {\n    const enablePolling = typeof poll_ !== 'undefined' ? poll_ : client.transport.type !== 'webSocket' && client.transport.type !== 'ipc';\n    const pollPendingTransactions = () => {\n      const observerId = (0, stringify_js_1.stringify)(['watchPendingTransactions', client.uid, batch, pollingInterval]);\n      return (0, observe_js_1.observe)(observerId, {\n        onTransactions,\n        onError\n      }, emit => {\n        let filter;\n        const unwatch = (0, poll_js_1.poll)(async () => {\n          try {\n            if (!filter) {\n              try {\n                filter = await (0, getAction_js_1.getAction)(client, createPendingTransactionFilter_js_1.createPendingTransactionFilter, 'createPendingTransactionFilter')({});\n                return;\n              } catch (err) {\n                unwatch();\n                throw err;\n              }\n            }\n            const hashes = await (0, getAction_js_1.getAction)(client, getFilterChanges_js_1.getFilterChanges, 'getFilterChanges')({\n              filter\n            });\n            if (hashes.length === 0) return;\n            if (batch) emit.onTransactions(hashes);else for (const hash of hashes) emit.onTransactions([hash]);\n          } catch (err) {\n            emit.onError?.(err);\n          }\n        }, {\n          emitOnBegin: true,\n          interval: pollingInterval\n        });\n        return async () => {\n          if (filter) await (0, getAction_js_1.getAction)(client, uninstallFilter_js_1.uninstallFilter, 'uninstallFilter')({\n            filter\n          });\n          unwatch();\n        };\n      });\n    };\n    const subscribePendingTransactions = () => {\n      let active = true;\n      let unsubscribe = () => active = false;\n      (async () => {\n        try {\n          const {\n            unsubscribe: unsubscribe_\n          } = await client.transport.subscribe({\n            params: ['newPendingTransactions'],\n            onData(data) {\n              if (!active) return;\n              const transaction = data.result;\n              onTransactions([transaction]);\n            },\n            onError(error) {\n              onError?.(error);\n            }\n          });\n          unsubscribe = unsubscribe_;\n          if (!active) unsubscribe();\n        } catch (err) {\n          onError?.(err);\n        }\n      })();\n      return () => unsubscribe();\n    };\n    return enablePolling ? pollPendingTransactions() : subscribePendingTransactions();\n  }\n});","lineCount":89,"map":[[2,2,1,0],[2,14,1,12],[4,2,2,0,"Object"],[4,8,2,6],[4,9,2,7,"defineProperty"],[4,23,2,21],[4,24,2,22,"exports"],[4,31,2,29],[4,33,2,31],[4,45,2,43],[4,47,2,45],[5,4,2,47,"value"],[5,9,2,52],[5,11,2,54],[6,2,2,59],[6,3,2,60],[6,4,2,61],[7,2,3,0,"exports"],[7,9,3,7],[7,10,3,8,"watchPendingTransactions"],[7,34,3,32],[7,37,3,35,"watchPendingTransactions"],[7,61,3,59],[8,2,4,0],[8,8,4,6,"getAction_js_1"],[8,22,4,20],[8,25,4,23,"require"],[8,32,4,30],[8,33,4,30,"_dependencyMap"],[8,47,4,30],[8,78,4,57],[8,79,4,58],[9,2,5,0],[9,8,5,6,"observe_js_1"],[9,20,5,18],[9,23,5,21,"require"],[9,30,5,28],[9,31,5,28,"_dependencyMap"],[9,45,5,28],[9,74,5,53],[9,75,5,54],[10,2,6,0],[10,8,6,6,"poll_js_1"],[10,17,6,15],[10,20,6,18,"require"],[10,27,6,25],[10,28,6,25,"_dependencyMap"],[10,42,6,25],[10,68,6,47],[10,69,6,48],[11,2,7,0],[11,8,7,6,"stringify_js_1"],[11,22,7,20],[11,25,7,23,"require"],[11,32,7,30],[11,33,7,30,"_dependencyMap"],[11,47,7,30],[11,78,7,57],[11,79,7,58],[12,2,8,0],[12,8,8,6,"createPendingTransactionFilter_js_1"],[12,43,8,41],[12,46,8,44,"require"],[12,53,8,51],[12,54,8,51,"_dependencyMap"],[12,68,8,51],[12,110,8,89],[12,111,8,90],[13,2,9,0],[13,8,9,6,"getFilterChanges_js_1"],[13,29,9,27],[13,32,9,30,"require"],[13,39,9,37],[13,40,9,37,"_dependencyMap"],[13,54,9,37],[13,82,9,61],[13,83,9,62],[14,2,10,0],[14,8,10,6,"uninstallFilter_js_1"],[14,28,10,26],[14,31,10,29,"require"],[14,38,10,36],[14,39,10,36,"_dependencyMap"],[14,53,10,36],[14,80,10,59],[14,81,10,60],[15,2,11,0],[15,11,11,9,"watchPendingTransactions"],[15,35,11,33,"watchPendingTransactions"],[15,36,11,34,"client"],[15,42,11,40],[15,44,11,42],[16,4,11,44,"batch"],[16,9,11,49],[16,12,11,52],[16,16,11,56],[17,4,11,58,"onError"],[17,11,11,65],[18,4,11,67,"onTransactions"],[18,18,11,81],[19,4,11,83,"poll"],[19,8,11,87],[19,10,11,89,"poll_"],[19,15,11,94],[20,4,11,96,"pollingInterval"],[20,19,11,111],[20,22,11,114,"client"],[20,28,11,120],[20,29,11,121,"pollingInterval"],[21,2,11,138],[21,3,11,139],[21,5,11,141],[22,4,12,4],[22,10,12,10,"enablePolling"],[22,23,12,23],[22,26,12,26],[22,33,12,33,"poll_"],[22,38,12,38],[22,43,12,43],[22,54,12,54],[22,57,13,10,"poll_"],[22,62,13,15],[22,65,14,10,"client"],[22,71,14,16],[22,72,14,17,"transport"],[22,81,14,26],[22,82,14,27,"type"],[22,86,14,31],[22,91,14,36],[22,102,14,47],[22,106,14,51,"client"],[22,112,14,57],[22,113,14,58,"transport"],[22,122,14,67],[22,123,14,68,"type"],[22,127,14,72],[22,132,14,77],[22,137,14,82],[23,4,15,4],[23,10,15,10,"pollPendingTransactions"],[23,33,15,33],[23,36,15,36,"pollPendingTransactions"],[23,37,15,36],[23,42,15,42],[24,6,16,8],[24,12,16,14,"observerId"],[24,22,16,24],[24,25,16,27],[24,26,16,28],[24,27,16,29],[24,29,16,31,"stringify_js_1"],[24,43,16,45],[24,44,16,46,"stringify"],[24,53,16,55],[24,55,16,57],[24,56,17,12],[24,82,17,38],[24,84,18,12,"client"],[24,90,18,18],[24,91,18,19,"uid"],[24,94,18,22],[24,96,19,12,"batch"],[24,101,19,17],[24,103,20,12,"pollingInterval"],[24,118,20,27],[24,119,21,9],[24,120,21,10],[25,6,22,8],[25,13,22,15],[25,14,22,16],[25,15,22,17],[25,17,22,19,"observe_js_1"],[25,29,22,31],[25,30,22,32,"observe"],[25,37,22,39],[25,39,22,41,"observerId"],[25,49,22,51],[25,51,22,53],[26,8,22,55,"onTransactions"],[26,22,22,69],[27,8,22,71,"onError"],[28,6,22,79],[28,7,22,80],[28,9,22,83,"emit"],[28,13,22,87],[28,17,22,92],[29,8,23,12],[29,12,23,16,"filter"],[29,18,23,22],[30,8,24,12],[30,14,24,18,"unwatch"],[30,21,24,25],[30,24,24,28],[30,25,24,29],[30,26,24,30],[30,28,24,32,"poll_js_1"],[30,37,24,41],[30,38,24,42,"poll"],[30,42,24,46],[30,44,24,48],[30,56,24,60],[31,10,25,16],[31,14,25,20],[32,12,26,20],[32,16,26,24],[32,17,26,25,"filter"],[32,23,26,31],[32,25,26,33],[33,14,27,24],[33,18,27,28],[34,16,28,28,"filter"],[34,22,28,34],[34,25,28,37],[34,31,28,43],[34,32,28,44],[34,33,28,45],[34,35,28,47,"getAction_js_1"],[34,49,28,61],[34,50,28,62,"getAction"],[34,59,28,71],[34,61,28,73,"client"],[34,67,28,79],[34,69,28,81,"createPendingTransactionFilter_js_1"],[34,104,28,116],[34,105,28,117,"createPendingTransactionFilter"],[34,135,28,147],[34,137,28,149],[34,169,28,181],[34,170,28,182],[34,171,28,183],[34,172,28,184],[34,173,28,185],[34,174,28,186],[35,16,29,28],[36,14,30,24],[36,15,30,25],[36,16,31,24],[36,23,31,31,"err"],[36,26,31,34],[36,28,31,36],[37,16,32,28,"unwatch"],[37,23,32,35],[37,24,32,36],[37,25,32,37],[38,16,33,28],[38,22,33,34,"err"],[38,25,33,37],[39,14,34,24],[40,12,35,20],[41,12,36,20],[41,18,36,26,"hashes"],[41,24,36,32],[41,27,36,35],[41,33,36,41],[41,34,36,42],[41,35,36,43],[41,37,36,45,"getAction_js_1"],[41,51,36,59],[41,52,36,60,"getAction"],[41,61,36,69],[41,63,36,71,"client"],[41,69,36,77],[41,71,36,79,"getFilterChanges_js_1"],[41,92,36,100],[41,93,36,101,"getFilterChanges"],[41,109,36,117],[41,111,36,119],[41,129,36,137],[41,130,36,138],[41,131,36,139],[42,14,36,141,"filter"],[43,12,36,148],[43,13,36,149],[43,14,36,150],[44,12,37,20],[44,16,37,24,"hashes"],[44,22,37,30],[44,23,37,31,"length"],[44,29,37,37],[44,34,37,42],[44,35,37,43],[44,37,38,24],[45,12,39,20],[45,16,39,24,"batch"],[45,21,39,29],[45,23,40,24,"emit"],[45,27,40,28],[45,28,40,29,"onTransactions"],[45,42,40,43],[45,43,40,44,"hashes"],[45,49,40,50],[45,50,40,51],[45,51,40,52],[45,56,42,24],[45,61,42,29],[45,67,42,35,"hash"],[45,71,42,39],[45,75,42,43,"hashes"],[45,81,42,49],[45,83,43,28,"emit"],[45,87,43,32],[45,88,43,33,"onTransactions"],[45,102,43,47],[45,103,43,48],[45,104,43,49,"hash"],[45,108,43,53],[45,109,43,54],[45,110,43,55],[46,10,44,16],[46,11,44,17],[46,12,45,16],[46,19,45,23,"err"],[46,22,45,26],[46,24,45,28],[47,12,46,20,"emit"],[47,16,46,24],[47,17,46,25,"onError"],[47,24,46,32],[47,27,46,35,"err"],[47,30,46,38],[47,31,46,39],[48,10,47,16],[49,8,48,12],[49,9,48,13],[49,11,48,15],[50,10,49,16,"emitOnBegin"],[50,21,49,27],[50,23,49,29],[50,27,49,33],[51,10,50,16,"interval"],[51,18,50,24],[51,20,50,26,"pollingInterval"],[52,8,51,12],[52,9,51,13],[52,10,51,14],[53,8,52,12],[53,15,52,19],[53,27,52,31],[54,10,53,16],[54,14,53,20,"filter"],[54,20,53,26],[54,22,54,20],[54,28,54,26],[54,29,54,27],[54,30,54,28],[54,32,54,30,"getAction_js_1"],[54,46,54,44],[54,47,54,45,"getAction"],[54,56,54,54],[54,58,54,56,"client"],[54,64,54,62],[54,66,54,64,"uninstallFilter_js_1"],[54,86,54,84],[54,87,54,85,"uninstallFilter"],[54,102,54,100],[54,104,54,102],[54,121,54,119],[54,122,54,120],[54,123,54,121],[55,12,54,123,"filter"],[56,10,54,130],[56,11,54,131],[56,12,54,132],[57,10,55,16,"unwatch"],[57,17,55,23],[57,18,55,24],[57,19,55,25],[58,8,56,12],[58,9,56,13],[59,6,57,8],[59,7,57,9],[59,8,57,10],[60,4,58,4],[60,5,58,5],[61,4,59,4],[61,10,59,10,"subscribePendingTransactions"],[61,38,59,38],[61,41,59,41,"subscribePendingTransactions"],[61,42,59,41],[61,47,59,47],[62,6,60,8],[62,10,60,12,"active"],[62,16,60,18],[62,19,60,21],[62,23,60,25],[63,6,61,8],[63,10,61,12,"unsubscribe"],[63,21,61,23],[63,24,61,26,"unsubscribe"],[63,25,61,26],[63,30,61,33,"active"],[63,36,61,39],[63,39,61,42],[63,44,61,48],[64,6,62,8],[64,7,62,9],[64,19,62,21],[65,8,63,12],[65,12,63,16],[66,10,64,16],[66,16,64,22],[67,12,64,24,"unsubscribe"],[67,23,64,35],[67,25,64,37,"unsubscribe_"],[68,10,64,50],[68,11,64,51],[68,14,64,54],[68,20,64,60,"client"],[68,26,64,66],[68,27,64,67,"transport"],[68,36,64,76],[68,37,64,77,"subscribe"],[68,46,64,86],[68,47,64,87],[69,12,65,20,"params"],[69,18,65,26],[69,20,65,28],[69,21,65,29],[69,45,65,53],[69,46,65,54],[70,12,66,20,"onData"],[70,18,66,26,"onData"],[70,19,66,27,"data"],[70,23,66,31],[70,25,66,33],[71,14,67,24],[71,18,67,28],[71,19,67,29,"active"],[71,25,67,35],[71,27,68,28],[72,14,69,24],[72,20,69,30,"transaction"],[72,31,69,41],[72,34,69,44,"data"],[72,38,69,48],[72,39,69,49,"result"],[72,45,69,55],[73,14,70,24,"onTransactions"],[73,28,70,38],[73,29,70,39],[73,30,70,40,"transaction"],[73,41,70,51],[73,42,70,52],[73,43,70,53],[74,12,71,20],[74,13,71,21],[75,12,72,20,"onError"],[75,19,72,27,"onError"],[75,20,72,28,"error"],[75,25,72,33],[75,27,72,35],[76,14,73,24,"onError"],[76,21,73,31],[76,24,73,34,"error"],[76,29,73,39],[76,30,73,40],[77,12,74,20],[78,10,75,16],[78,11,75,17],[78,12,75,18],[79,10,76,16,"unsubscribe"],[79,21,76,27],[79,24,76,30,"unsubscribe_"],[79,36,76,42],[80,10,77,16],[80,14,77,20],[80,15,77,21,"active"],[80,21,77,27],[80,23,78,20,"unsubscribe"],[80,34,78,31],[80,35,78,32],[80,36,78,33],[81,8,79,12],[81,9,79,13],[81,10,80,12],[81,17,80,19,"err"],[81,20,80,22],[81,22,80,24],[82,10,81,16,"onError"],[82,17,81,23],[82,20,81,26,"err"],[82,23,81,29],[82,24,81,30],[83,8,82,12],[84,6,83,8],[84,7,83,9],[84,9,83,11],[84,10,83,12],[85,6,84,8],[85,13,84,15],[85,19,84,21,"unsubscribe"],[85,30,84,32],[85,31,84,33],[85,32,84,34],[86,4,85,4],[86,5,85,5],[87,4,86,4],[87,11,86,11,"enablePolling"],[87,24,86,24],[87,27,87,10,"pollPendingTransactions"],[87,50,87,33],[87,51,87,34],[87,52,87,35],[87,55,88,10,"subscribePendingTransactions"],[87,83,88,38],[87,84,88,39],[87,85,88,40],[88,2,89,0],[89,0,89,1],[89,3]],"functionMap":{"names":["<global>","watchPendingTransactions","pollPendingTransactions","<anonymous>","subscribePendingTransactions","unsubscribe","client.transport.subscribe$argument_0.onData","client.transport.subscribe$argument_0.onError"],"mappings":"AAA;ACU;oCCI;kFCO;SDmC;KDC;yCGC;0BCE,sBD;SDC;oBGI;qBHK;oBIC;qBJE;SCS;eDC,mBC;KHC;CDI"},"hasCjsExports":true},"type":"js/module"}]}